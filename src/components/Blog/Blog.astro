---
import { storyblokEditable, useStoryblokApi } from '@storyblok/astro'

import ArticleCard from './ArticleCard.astro'

import getDate from '../../helpers/getDate'
 
const { blok } = Astro.props
 
const storyblokApi = useStoryblokApi()
const { data } = await storyblokApi.get(`cdn/stories`, {
  version: 'draft',
  starts_with: 'blog/',
  is_startpage: 0,
})
 
const articles = data.stories



---

<section class="py-28 px-4 container-wrapper md:px-8" {...storyblokEditable(blok)}>
    <div class="text-center">
        <h3 class="text-gray-800 text-3xl font-extrabold sm:text-4xl">
            Блог
        </h3>
        <p class="mt-3 text-gray-600">
            Описание
        </p>
    </div>
    <div class="mt-12 grid gap-10 sm:grid-cols-2 lg:grid-cols-3">
        {
            articles.map(article => {
                if (typeof article === 'object') {
                article.content.slug = article.slug

                article.content.date = getDate(article.content.date)

                return <ArticleCard {article} />
                }
            }
            )
        }
    </div>
</section>